## 1. DecisionTreeClassifier 실습

import pandas as pd
from sklearn.model_selection import train_test_split  #학습,테스트용 나누는 라이브러리
from sklearn.preprocessing import LabelEncoder    #문자열 -> 숫자로 변환 바꿔야지 학습할수 있다고함
from sklearn.tree import DecisionTreeClassifier   #학습모델 라이브러리 DecisionTreeClassofoer() 써서 모델 만들고 
                                                  # fit()으로 학습

file_path = "C:/Users/user/Desktop/가천대/3학년 1학기/인공지능개론/iris.csv"
df = pd.read_csv(file_path) #df에 읽어온 파일 집어넣기

df.head()
df.columns

#iloc은 표처럼 행렬형태의 데이터에서 행,열을 선택하는 함수? 같은것
#반대로 선형성이 없는 데이터에서는 못씀
X = df.iloc[:, :-1] # [행, 열]
Y = df.iloc[:, -1]

# 문자열 숫자변환 라이브러리사용
le = LabelEncoder() #
Y = le.fit_transform(Y)

#학습, 테스트 데이터 분리
X_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size=0.3, random_state=42)

dt_model = DecisionTreeClassifier()
dt_model.fit(X_train, Y_train)  #학습

dt_preds = dt_model.predict(X_test)

decoded_preds = le.inverse_transform(dt_preds)

print("class:", dt_preds) #숫자예측 그대로
print("class:", decoded_preds) # 클래스 이름으로 변환
